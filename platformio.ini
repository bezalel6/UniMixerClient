; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[platformio]
default_envs = esp32-8048S070C

[env:esp32-8048S070C]
; Platform Configuration
platform = espressif32@6.5.0
framework = arduino
board = esp32-8048S070C
platform_packages = toolchain-xtensa-esp32s3@~8.4.0

; Build Configuration
build_unflags = -std=gnu++11

; Compiler Flags
build_flags =
    ; C++ Standard
    -std=gnu++2a

    ; LVGL Configuration
    '-D LV_CONF_PATH="${platformio.include_dir}/lv_conf.h"'

    ; Include project config
    -include PIOConfig.h

    ; Optimization
    -O2

    ; Warning flags
    -Wall
    -Wextra
    -Wno-missing-field-initializers
    -Wno-unused-parameter
    -Wno-unused-function
    -Wno-unused-variable

; Source Filters - Exclude deprecated code
build_src_filter =
    +<*>
    -<src/messaging/deprecated/*>

; Library Dependencies
lib_deps =
    rzeldent/esp32_smartdisplay@^2.1.0     ; Display driver for ESP32 smart displays
    bblanchon/ArduinoJson                   ; JSON parsing and serialization
    PubSubClient                            ; MQTT client (if needed)
    https://github.com/kokke/tiny-regex-c.git  ; Lightweight regex for embedded systems

; Serial Monitor Configuration
monitor_speed = 112500                      ; Non-standard baud rate for ESP32-S3
monitor_rts = 0                            ; Disable RTS to prevent reset
monitor_dtr = 0                            ; Disable DTR to prevent reset
monitor_filters = esp32_exception_decoder   ; Decode ESP32 crash dumps

; Upload Configuration
upload_protocol = esptool                   ; Standard ESP32 upload protocol
extra_scripts = pre:scripts/upload_bin.py   ; Custom upload script
